{"version":3,"sources":["../../../../node_modules/save/test/create-or-update.js"],"names":["should","require","module","exports","idProperty","getEngine","describe","it","done","error","engine","createOrUpdate","a","err","object","not","exist","have","property","newObject","newProperty","on","entity","eql","previousId","_id"],"mappings":"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","file":"create-or-update.js","sourcesContent":["var should = require('should')\n\nmodule.exports = function(idProperty, getEngine) {\n\n  describe('#createOrUpdate', function() {\n\n    it('should create a new object when no id is specified', function (done) {\n      getEngine(function (error, engine) {\n        engine.createOrUpdate({ a: 1 }, function (err, object) {\n          should.not.exist(err)\n          object.should.have.property('a')\n          object.should.have.property('_id')\n          done()\n        })\n      })\n    })\n\n    it('should return a clone of the object', function (done) {\n      var object = { a: 1 }\n      getEngine(function (error, engine) {\n        engine.createOrUpdate(object, function (err, newObject) {\n          should.not.exist(err)\n          newObject.newProperty = true\n          object.should.not.have.property('newProperty')\n          done()\n        })\n      })\n    })\n\n    it('should emit a \\'create\\' event when a new object is created', function (done) {\n      getEngine(function (error, engine) {\n        engine.on('create', function (entity) {\n          entity.should.eql({ a: 3 })\n          done()\n        })\n\n        engine.createOrUpdate({ a: 3 }, function () { })\n      })\n    })\n\n    it('should update the entity when it has already been saved', function (done) {\n      getEngine(function (error, engine) {\n        engine.createOrUpdate({ a: 5 }, function (err, object) {\n          var previousId = object._id\n          should.not.exist(err)\n          engine.createOrUpdate({ _id: previousId, a: 7 }, function (err, object) {\n            should.not.exist(err)\n            object._id.should.eql(previousId)\n            object.a.should.eql(7)\n            done()\n          })\n        })\n      })\n    })\n\n    it('should emit the \\'update\\' event when a object is updated', function (done) {\n      getEngine(function (error, engine) {\n        engine.on('update', function (object) {\n          object.a.should.eql(7)\n          done()\n        })\n\n        engine.createOrUpdate({ a: 5 }, function (err, object) {\n          var previousId = object._id\n          should.not.exist(err)\n          engine.createOrUpdate({ _id: previousId, a: 7 }, function () { })\n        })\n      })\n    })\n  })\n\n}\n"]}