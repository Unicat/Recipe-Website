{"version":3,"sources":["../../../../node_modules/nan/tools/1to2.js"],"names":["commander","require","fs","glob","groups","total","warning1","warning2","length","i","readFile","__dirname","err","data","version","JSON","parse","usage","process","argv","slice","outputHelp","push","join","groupcount","s","positive","match","negative","master","RegExp","map","a","replace","arguments","processFile","file","encoding","writeFile","matches","forEach"],"mappings":"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","file":"1to2.js","sourcesContent":["\n/*********************************************************************\n * NAN - Native Abstractions for Node.js\n *\n * Copyright (c) 2017 NAN contributors\n *\n * MIT License <https://github.com/nodejs/nan/blob/master/LICENSE.md>\n ********************************************************************/\n\nvar commander = require('commander'),\n    fs = require('fs'),\n    glob = require('glob'),\n    groups = [],\n    total = 0,\n    warning1 = '/* ERROR: Rewrite using Buffer */\\n',\n    warning2 = '\\\\/\\\\* ERROR\\\\: Rewrite using Buffer \\\\*\\\\/\\\\n',\n    length,\n    i;\n\nfs.readFile(__dirname + '/package.json', 'utf8', function (err, data) {\n  if (err) {\n    throw err;\n  }\n\n  commander\n      .version(JSON.parse(data).version)\n      .usage('[options] <file ...>')\n      .parse(process.argv);\n\n  if (!process.argv.slice(2).length) {\n    commander.outputHelp();\n  }\n});\n\n/* construct strings representing regular expressions\n   each expression contains a unique group allowing for identification of the match\n   the index of this key group, relative to the regular expression in question,\n    is indicated by the first array member */\n\n/* simple substistutions, key group is the entire match, 0 */\ngroups.push([0, [\n  '_NAN_',\n  'NODE_SET_METHOD',\n  'NODE_SET_PROTOTYPE_METHOD',\n  'NanAsciiString',\n  'NanEscapeScope',\n  'NanReturnValue',\n  'NanUcs2String'].join('|')]);\n\n/* substitutions of parameterless macros, key group is 1 */\ngroups.push([1, ['(', [\n  'NanEscapableScope',\n  'NanReturnNull',\n  'NanReturnUndefined',\n  'NanScope'].join('|'), ')\\\\(\\\\)'].join('')]);\n\n/* replace TryCatch with NanTryCatch once, gobbling possible namespace, key group 2 */\ngroups.push([2, '(?:(?:v8\\\\:\\\\:)?|(Nan)?)(TryCatch)']);\n\n/* NanNew(\"string\") will likely not fail a ToLocalChecked(), key group 1 */ \ngroups.push([1, ['(NanNew)', '(\\\\(\"[^\\\\\"]*\"[^\\\\)]*\\\\))(?!\\\\.ToLocalChecked\\\\(\\\\))'].join('')]);\n\n/* Removed v8 APIs, warn that the code needs rewriting using node::Buffer, key group 2 */\ngroups.push([2, ['(', warning2, ')?', '^.*?(', [\n      'GetIndexedPropertiesExternalArrayDataLength',\n      'GetIndexedPropertiesExternalArrayData',\n      'GetIndexedPropertiesExternalArrayDataType',\n      'GetIndexedPropertiesPixelData',\n      'GetIndexedPropertiesPixelDataLength',\n      'HasIndexedPropertiesInExternalArrayData',\n      'HasIndexedPropertiesInPixelData',\n      'SetIndexedPropertiesToExternalArrayData',\n      'SetIndexedPropertiesToPixelData'].join('|'), ')'].join('')]);\n\n/* No need for NanScope in V8-exposed methods, key group 2 */\ngroups.push([2, ['((', [\n      'NAN_METHOD',\n      'NAN_GETTER',\n      'NAN_SETTER',\n      'NAN_PROPERTY_GETTER',\n      'NAN_PROPERTY_SETTER',\n      'NAN_PROPERTY_ENUMERATOR',\n      'NAN_PROPERTY_DELETER',\n      'NAN_PROPERTY_QUERY',\n      'NAN_INDEX_GETTER',\n      'NAN_INDEX_SETTER',\n      'NAN_INDEX_ENUMERATOR',\n      'NAN_INDEX_DELETER',\n      'NAN_INDEX_QUERY'].join('|'), ')\\\\([^\\\\)]*\\\\)\\\\s*\\\\{)\\\\s*NanScope\\\\(\\\\)\\\\s*;'].join('')]);\n\n/* v8::Value::ToXXXXXXX returns v8::MaybeLocal<T>, key group 3 */\ngroups.push([3, ['([\\\\s\\\\(\\\\)])([^\\\\s\\\\(\\\\)]+)->(', [\n      'Boolean',\n      'Number',\n      'String',\n      'Object',\n      'Integer',\n      'Uint32',\n      'Int32'].join('|'), ')\\\\('].join('')]);\n\n/* v8::Value::XXXXXXXValue returns v8::Maybe<T>, key group 3 */\ngroups.push([3, ['([\\\\s\\\\(\\\\)])([^\\\\s\\\\(\\\\)]+)->((?:', [\n      'Boolean',\n      'Number',\n      'Integer',\n      'Uint32',\n      'Int32'].join('|'), ')Value)\\\\('].join('')]);\n\n/* NAN_WEAK_CALLBACK macro was removed, write out callback definition, key group 1 */\ngroups.push([1, '(NAN_WEAK_CALLBACK)\\\\(([^\\\\s\\\\)]+)\\\\)']);\n\n/* node::ObjectWrap and v8::Persistent have been replaced with Nan implementations, key group 1 */\ngroups.push([1, ['(', [\n  'NanDisposePersistent',\n  'NanObjectWrapHandle'].join('|'), ')\\\\s*\\\\(\\\\s*([^\\\\s\\\\)]+)'].join('')]);\n\n/* Since NanPersistent there is no need for NanMakeWeakPersistent, key group 1 */\ngroups.push([1, '(NanMakeWeakPersistent)\\\\s*\\\\(\\\\s*([^\\\\s,]+)\\\\s*,\\\\s*']);\n\n/* Many methods of v8::Object and others now return v8::MaybeLocal<T>, key group 3 */\ngroups.push([3, ['([\\\\s])([^\\\\s]+)->(', [\n  'GetEndColumn',\n  'GetFunction',\n  'GetLineNumber',\n  'NewInstance',\n  'GetPropertyNames',\n  'GetOwnPropertyNames',\n  'GetSourceLine',\n  'GetStartColumn',\n  'ObjectProtoToString',\n  'ToArrayIndex',\n  'ToDetailString',\n  'CallAsConstructor',\n  'CallAsFunction',\n  'CloneElementAt',\n  'Delete',\n  'ForceSet',\n  'Get',\n  'GetPropertyAttributes',\n  'GetRealNamedProperty',\n  'GetRealNamedPropertyInPrototypeChain',\n  'Has',\n  'HasOwnProperty',\n  'HasRealIndexedProperty',\n  'HasRealNamedCallbackProperty',\n  'HasRealNamedProperty',\n  'Set',\n  'SetAccessor',\n  'SetIndexedPropertyHandler',\n  'SetNamedPropertyHandler',\n  'SetPrototype'].join('|'), ')\\\\('].join('')]);\n\n/* You should get an error if any of these fail anyways,\n   or handle the error better, it is indicated either way, key group 2 */\ngroups.push([2, ['NanNew(<(?:v8\\\\:\\\\:)?(', ['Date', 'String', 'RegExp'].join('|'), ')>)(\\\\([^\\\\)]*\\\\))(?!\\\\.ToLocalChecked\\\\(\\\\))'].join('')]);\n\n/* v8::Value::Equals now returns a v8::Maybe, key group 3 */\ngroups.push([3, '([\\\\s\\\\(\\\\)])([^\\\\s\\\\(\\\\)]+)->(Equals)\\\\(([^\\\\s\\\\)]+)']);\n\n/* NanPersistent makes this unnecessary, key group 1 */\ngroups.push([1, '(NanAssignPersistent)(?:<v8\\\\:\\\\:[^>]+>)?\\\\(([^,]+),\\\\s*']);\n\n/* args has been renamed to info, key group 2 */\ngroups.push([2, '(\\\\W)(args)(\\\\W)'])\n\n/* node::ObjectWrap was replaced with NanObjectWrap, key group 2 */\ngroups.push([2, '(\\\\W)(?:node\\\\:\\\\:)?(ObjectWrap)(\\\\W)']);\n\n/* v8::Persistent was replaced with NanPersistent, key group 2 */\ngroups.push([2, '(\\\\W)(?:v8\\\\:\\\\:)?(Persistent)(\\\\W)']);\n\n/* counts the number of capturing groups in a well-formed regular expression,\n   ignoring non-capturing groups and escaped parentheses */\nfunction groupcount(s) {\n  var positive = s.match(/\\((?!\\?)/g),\n      negative = s.match(/\\\\\\(/g);\n  return (positive ? positive.length : 0) - (negative ? negative.length : 0);\n}\n\n/* compute the absolute position of each key group in the joined master RegExp */\nfor (i = 1, length = groups.length; i < length; i++) {\n\ttotal += groupcount(groups[i - 1][1]);\n\tgroups[i][0] += total;\n}\n\n/* create the master RegExp, whis is the union of all the groups' expressions */\nmaster = new RegExp(groups.map(function (a) { return a[1]; }).join('|'), 'gm');\n\n/* replacement function for String.replace, receives 21 arguments */\nfunction replace() {\n\t/* simple expressions */\n      switch (arguments[groups[0][0]]) {\n        case '_NAN_':\n          return 'NAN_';\n        case 'NODE_SET_METHOD':\n          return 'NanSetMethod';\n        case 'NODE_SET_PROTOTYPE_METHOD':\n          return 'NanSetPrototypeMethod';\n        case 'NanAsciiString':\n          return 'NanUtf8String';\n        case 'NanEscapeScope':\n          return 'scope.Escape';\n        case 'NanReturnNull':\n          return 'info.GetReturnValue().SetNull';\n        case 'NanReturnValue':\n          return 'info.GetReturnValue().Set';\n        case 'NanUcs2String':\n          return 'v8::String::Value';\n        default:\n      }\n\n      /* macros without arguments */\n      switch (arguments[groups[1][0]]) {\n        case 'NanEscapableScope':\n          return 'NanEscapableScope scope'\n        case 'NanReturnUndefined':\n          return 'return';\n        case 'NanScope':\n          return 'NanScope scope';\n        default:\n      }\n\n      /* TryCatch, emulate negative backref */\n      if (arguments[groups[2][0]] === 'TryCatch') {\n        return arguments[groups[2][0] - 1] ? arguments[0] : 'NanTryCatch';\n      }\n\n      /* NanNew(\"foo\") --> NanNew(\"foo\").ToLocalChecked() */\n      if (arguments[groups[3][0]] === 'NanNew') {\n        return [arguments[0], '.ToLocalChecked()'].join('');\n      }\n\n      /* insert warning for removed functions as comment on new line above */\n      switch (arguments[groups[4][0]]) {\n        case 'GetIndexedPropertiesExternalArrayData':\n        case 'GetIndexedPropertiesExternalArrayDataLength':\n        case 'GetIndexedPropertiesExternalArrayDataType':\n        case 'GetIndexedPropertiesPixelData':\n        case 'GetIndexedPropertiesPixelDataLength':\n        case 'HasIndexedPropertiesInExternalArrayData':\n        case 'HasIndexedPropertiesInPixelData':\n        case 'SetIndexedPropertiesToExternalArrayData':\n        case 'SetIndexedPropertiesToPixelData':\n          return arguments[groups[4][0] - 1] ? arguments[0] : [warning1, arguments[0]].join('');\n        default:\n      }\n\n     /* remove unnecessary NanScope() */\n      switch (arguments[groups[5][0]]) {\n        case 'NAN_GETTER':\n        case 'NAN_METHOD':\n        case 'NAN_SETTER':\n        case 'NAN_INDEX_DELETER':\n        case 'NAN_INDEX_ENUMERATOR':\n        case 'NAN_INDEX_GETTER':\n        case 'NAN_INDEX_QUERY':\n        case 'NAN_INDEX_SETTER':\n        case 'NAN_PROPERTY_DELETER':\n        case 'NAN_PROPERTY_ENUMERATOR':\n        case 'NAN_PROPERTY_GETTER':\n        case 'NAN_PROPERTY_QUERY':\n        case 'NAN_PROPERTY_SETTER':\n          return arguments[groups[5][0] - 1];\n        default:\n      }\n\n      /* Value converstion */\n      switch (arguments[groups[6][0]]) {\n        case 'Boolean':\n        case 'Int32':\n        case 'Integer':\n        case 'Number':\n        case 'Object':\n        case 'String':\n        case 'Uint32':\n          return [arguments[groups[6][0] - 2], 'NanTo<v8::', arguments[groups[6][0]], '>(',  arguments[groups[6][0] - 1]].join('');\n        default:\n      }\n\n      /* other value conversion */\n      switch (arguments[groups[7][0]]) {\n        case 'BooleanValue':\n          return [arguments[groups[7][0] - 2], 'NanTo<bool>(', arguments[groups[7][0] - 1]].join('');\n        case 'Int32Value':\n          return [arguments[groups[7][0] - 2], 'NanTo<int32_t>(', arguments[groups[7][0] - 1]].join('');\n        case 'IntegerValue':\n          return [arguments[groups[7][0] - 2], 'NanTo<int64_t>(', arguments[groups[7][0] - 1]].join('');\n        case 'Uint32Value':\n          return [arguments[groups[7][0] - 2], 'NanTo<uint32_t>(', arguments[groups[7][0] - 1]].join('');\n        default:\n      }\n\n      /* NAN_WEAK_CALLBACK */\n      if (arguments[groups[8][0]] === 'NAN_WEAK_CALLBACK') {\n        return ['template<typename T>\\nvoid ',\n          arguments[groups[8][0] + 1], '(const NanWeakCallbackInfo<T> &data)'].join('');\n      }\n\n      /* use methods on NAN classes instead */\n      switch (arguments[groups[9][0]]) {\n        case 'NanDisposePersistent':\n          return [arguments[groups[9][0] + 1], '.Reset('].join('');\n        case 'NanObjectWrapHandle':\n          return [arguments[groups[9][0] + 1], '->handle('].join('');\n        default:\n      }\n\n      /* use method on NanPersistent instead */\n      if (arguments[groups[10][0]] === 'NanMakeWeakPersistent') {\n        return arguments[groups[10][0] + 1] + '.SetWeak(';\n      }\n\n      /* These return Maybes, the upper ones take no arguments */\n      switch (arguments[groups[11][0]]) {\n        case 'GetEndColumn':\n        case 'GetFunction':\n        case 'GetLineNumber':\n        case 'GetOwnPropertyNames':\n        case 'GetPropertyNames':\n        case 'GetSourceLine':\n        case 'GetStartColumn':\n        case 'NewInstance':\n        case 'ObjectProtoToString':\n        case 'ToArrayIndex':\n        case 'ToDetailString':\n          return [arguments[groups[11][0] - 2], 'Nan', arguments[groups[11][0]], '(', arguments[groups[11][0] - 1]].join('');\n        case 'CallAsConstructor':\n        case 'CallAsFunction':\n        case 'CloneElementAt':\n        case 'Delete':\n        case 'ForceSet':\n        case 'Get':\n        case 'GetPropertyAttributes':\n        case 'GetRealNamedProperty':\n        case 'GetRealNamedPropertyInPrototypeChain':\n        case 'Has':\n        case 'HasOwnProperty':\n        case 'HasRealIndexedProperty':\n        case 'HasRealNamedCallbackProperty':\n        case 'HasRealNamedProperty':\n        case 'Set':\n        case 'SetAccessor':\n        case 'SetIndexedPropertyHandler':\n        case 'SetNamedPropertyHandler':\n        case 'SetPrototype':\n          return [arguments[groups[11][0] - 2], 'Nan', arguments[groups[11][0]], '(', arguments[groups[11][0] - 1], ', '].join('');\n        default:\n      }\n\n      /* Automatic ToLocalChecked(), take it or leave it */\n      switch (arguments[groups[12][0]]) {\n        case 'Date':\n        case 'String':\n        case 'RegExp':\n          return ['NanNew', arguments[groups[12][0] - 1], arguments[groups[12][0] + 1], '.ToLocalChecked()'].join('');\n        default:\n      }\n\n      /* NanEquals is now required for uniformity */\n      if (arguments[groups[13][0]] === 'Equals') {\n        return [arguments[groups[13][0] - 1], 'NanEquals(', arguments[groups[13][0] - 1], ', ', arguments[groups[13][0] + 1]].join('');\n      }\n\n      /* use method on replacement class instead */\n      if (arguments[groups[14][0]] === 'NanAssignPersistent') {\n        return [arguments[groups[14][0] + 1], '.Reset('].join('');\n      }\n\n      /* args --> info */\n      if (arguments[groups[15][0]] === 'args') {\n        return [arguments[groups[15][0] - 1], 'info', arguments[groups[15][0] + 1]].join('');\n      }\n\n      /* ObjectWrap --> NanObjectWrap */\n      if (arguments[groups[16][0]] === 'ObjectWrap') {\n        return [arguments[groups[16][0] - 1], 'NanObjectWrap', arguments[groups[16][0] + 1]].join('');\n      }\n\n      /* Persistent --> NanPersistent */\n      if (arguments[groups[17][0]] === 'Persistent') {\n        return [arguments[groups[17][0] - 1], 'NanPersistent', arguments[groups[17][0] + 1]].join('');\n      }\n\n      /* This should not happen. A switch is probably missing a case if it does. */\n      throw 'Unhandled match: ' + arguments[0];\n}\n\n/* reads a file, runs replacement and writes it back */\nfunction processFile(file) {\n  fs.readFile(file, {encoding: 'utf8'}, function (err, data) {\n    if (err) {\n      throw err;\n    }\n\n    /* run replacement twice, might need more runs */\n    fs.writeFile(file, data.replace(master, replace).replace(master, replace), function (err) {\n      if (err) {\n        throw err;\n      }\n    });\n  });\n}\n\n/* process file names from command line and process the identified files */\nfor (i = 2, length = process.argv.length; i < length; i++) {\n  glob(process.argv[i], function (err, matches) {\n    if (err) {\n      throw err;\n    }\n    matches.forEach(processFile);\n  });\n}\n"]}