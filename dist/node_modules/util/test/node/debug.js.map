{"version":3,"sources":["../../../../../node_modules/util/test/node/debug.js"],"names":["assert","require","util","process","argv","child","parent","test","environ","shouldWrite","expectErr","expectOut","didTest","spawn","execPath","__filename","env","NODE_DEBUG","split","join","pid","err","stderr","setEncoding","on","c","out","stdout","equal","console","log","debug","debuglog","is","foo"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,SAASC,QAAQ,QAAR,CAAb;AACA,IAAIC,OAAOD,QAAQ,QAAR,CAAX;;AAEA,IAAIE,QAAQC,IAAR,CAAa,CAAb,MAAoB,OAAxB,EACEC,QADF,KAGEC;;AAEF,SAASA,MAAT,GAAkB;AAChBC,OAAK,aAAL,EAAoB,IAApB;AACAA,OAAK,SAAL,EAAgB,IAAhB;AACAA,OAAK,SAAL,EAAgB,IAAhB;AACAA,OAAK,KAAL,EAAY,IAAZ;AACAA,OAAK,SAAL,EAAgB,KAAhB;AACAA,OAAK,EAAL,EAAS,KAAT;AACD;;AAED,SAASA,IAAT,CAAcC,OAAd,EAAuBC,WAAvB,EAAoC;AAClC,MAAIC,YAAY,EAAhB;AACA,MAAID,WAAJ,EAAiB;AACfC,gBAAY,gDACA,wDADZ;AAED;AACD,MAAIC,YAAY,MAAhB;AACA,MAAIC,UAAU,KAAd;;AAEA,MAAIC,QAAQZ,QAAQ,eAAR,EAAyBY,KAArC;AACA,MAAIR,QAAQQ,MAAMV,QAAQW,QAAd,EAAwB,CAACC,UAAD,EAAa,OAAb,CAAxB,EAA+C;AACzDC,SAAK,EAAEC,YAAYT,OAAd;AADoD,GAA/C,CAAZ;;AAIAE,cAAYA,UAAUQ,KAAV,CAAgB,OAAhB,EAAyBC,IAAzB,CAA8Bd,MAAMe,GAApC,CAAZ;;AAEA,MAAIC,MAAM,EAAV;AACAhB,QAAMiB,MAAN,CAAaC,WAAb,CAAyB,MAAzB;AACAlB,QAAMiB,MAAN,CAAaE,EAAb,CAAgB,MAAhB,EAAwB,UAASC,CAAT,EAAY;AAClCJ,WAAOI,CAAP;AACD,GAFD;;AAIA,MAAIC,MAAM,EAAV;AACArB,QAAMsB,MAAN,CAAaJ,WAAb,CAAyB,MAAzB;AACAlB,QAAMsB,MAAN,CAAaH,EAAb,CAAgB,MAAhB,EAAwB,UAASC,CAAT,EAAY;AAClCC,WAAOD,CAAP;AACD,GAFD;;AAIApB,QAAMmB,EAAN,CAAS,OAAT,EAAkB,UAASC,CAAT,EAAY;AAC5BzB,WAAO,CAACyB,CAAR;AACAzB,WAAO4B,KAAP,CAAaP,GAAb,EAAkBX,SAAlB;AACAV,WAAO4B,KAAP,CAAaF,GAAb,EAAkBf,SAAlB;AACAC,cAAU,IAAV;AACAiB,YAAQC,GAAR,CAAY,UAAZ,EAAwBtB,OAAxB,EAAiCC,WAAjC;AACD,GAND;;AAQAN,UAAQqB,EAAR,CAAW,MAAX,EAAmB,YAAW;AAC5BxB,WAAOY,OAAP;AACD,GAFD;AAGD;;AAGD,SAASP,KAAT,GAAiB;AACf,MAAI0B,QAAQ7B,KAAK8B,QAAL,CAAc,KAAd,CAAZ;AACAD,QAAM,MAAN,EAAc,EAAEE,IAAI,GAAN,EAAd,EAA2B,WAA3B;AACAF,QAAM,4BAAN,EAAoC,IAApC,EAA0C,MAA1C,EAAkD,EAAEG,KAAK,KAAP,EAAlD;AACAL,UAAQC,GAAR,CAAY,IAAZ;AACD","file":"debug.js","sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar assert = require('assert');\nvar util = require('../../');\n\nif (process.argv[2] === 'child')\n  child();\nelse\n  parent();\n\nfunction parent() {\n  test('foo,tud,bar', true);\n  test('foo,tud', true);\n  test('tud,bar', true);\n  test('tud', true);\n  test('foo,bar', false);\n  test('', false);\n}\n\nfunction test(environ, shouldWrite) {\n  var expectErr = '';\n  if (shouldWrite) {\n    expectErr = 'TUD %PID%: this { is: \\'a\\' } /debugging/\\n' +\n                'TUD %PID%: number=1234 string=asdf obj={\"foo\":\"bar\"}\\n';\n  }\n  var expectOut = 'ok\\n';\n  var didTest = false;\n\n  var spawn = require('child_process').spawn;\n  var child = spawn(process.execPath, [__filename, 'child'], {\n    env: { NODE_DEBUG: environ }\n  });\n\n  expectErr = expectErr.split('%PID%').join(child.pid);\n\n  var err = '';\n  child.stderr.setEncoding('utf8');\n  child.stderr.on('data', function(c) {\n    err += c;\n  });\n\n  var out = '';\n  child.stdout.setEncoding('utf8');\n  child.stdout.on('data', function(c) {\n    out += c;\n  });\n\n  child.on('close', function(c) {\n    assert(!c);\n    assert.equal(err, expectErr);\n    assert.equal(out, expectOut);\n    didTest = true;\n    console.log('ok %j %j', environ, shouldWrite);\n  });\n\n  process.on('exit', function() {\n    assert(didTest);\n  });\n}\n\n\nfunction child() {\n  var debug = util.debuglog('tud');\n  debug('this', { is: 'a' }, /debugging/);\n  debug('number=%d string=%s obj=%j', 1234, 'asdf', { foo: 'bar' });\n  console.log('ok');\n}\n"]}